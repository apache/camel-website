-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- ---
title: "Apache Camel Security Advisory - CVE-2025-29891"
date: 2025-03-12T07:30:42+02:00
url: /security/CVE-2025-29891.html
draft: false
type: security-advisory
cve: CVE-2025-29891
severity: HIGH
summary: "Camel Message Header Injection through request parameters"
description: "This vulnerability is present in Camel's default incoming header filter, that allows an attacker to include Camel specific headers that for some Camel components can alter the behaviours such as the camel-bean component, or the camel-exec component. If you have Camel applications that are directly connected to the internet via HTTP, then an attacker could include parameters in the HTTP requests that are sent to the Camel application that incorrectly get translated into headers. The headers could be both provided as request parameters for an HTTP methods invocation or as part of the payload of the HTTP methods invocation.All the known Camel HTTP component such as camel-servlet, camel-jetty, camel-undertow, camel-platform-http, and camel-netty-http would be vulnerable out of the box."
mitigation: "Users are recommended to upgrade to version 4.10.2 for 4.10.x LTS, 4.8.5 for 4.8.x LTS and 3.22.4 for 3.x releases. Also, users could use removeHeaders EIP, to filter out anything like 'cAmel, cAMEL' etc, or in general everything not starting with 'Camel', 'camel' or 'org.apache.camel.'."
credit: "This issue was discovered by Ryan Barnett of Akamai Security Intelligence Group (SIG)"
affected: Apache Camel 4.10.0 before 4.10.2. Apache Camel 4.8.0 before 4.8.5. Apache Camel 3.10.0 before 3.22.4.
fixed: 3.22.4, 4.8.5 and 4.10.2 
- ---

The JIRA ticket: https://issues.apache.org/jira/browse/CAMEL-21828 refers to the various commits that resolved the issue, and have more details.
This CVE is related to the CVE-2025-27636: while they have the same root cause and are fixed with the same fix, CVE-2025-27636 was assumed to only be exploitable if an attacker could add malicious HTTP headers, while we have now determined that it is also exploitable via HTTP parameters. Like in CVE-2025-27636, exploitation is only possible if the Camel route uses particular vulnerable components.
-----BEGIN PGP SIGNATURE-----

iQEzBAEBCAAdFiEEJ2Y0ButtuvUpHyYV406fOAL/QQAFAmfRl+MACgkQ406fOAL/
QQBa0wf/ZnUKPl5hlkSAXMiDdVPJx1v/ElaWrnKufCd+2aiefK44IiNjX3keRAkt
nHPdNBIv/+qiEqKPv8CMuMYiC8s8S66yXenSXp3fEnrABMganZM+ibGmHnN2jTs3
2EpYxQ6xGsx3AJBT5DmscnrypC2eMBNn0xsNW2kJp878nnwyalZBJhbdtYOHBWdP
0znvaPzfGxHzguCRP/ohG3o7SpunUitsuhsDpJDeHeoYZK6rl3qDeZWx9JiLgkGp
vl2zDGNHoA1ctSZUGMk+HXHdLXTHXjqjRf6ahdP5z9wcF9Q64RP7XBMkQZMllRgL
k41mrx9TINgMjOocnmceh43bjEst5g==
=P7KQ
-----END PGP SIGNATURE-----
